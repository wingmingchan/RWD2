<global-velocity-code>
    <!-- Strings like -dispatch_macro_name-, -single_group_name- and -macro_name- are place-holders,
    to be replaced by real values; everything else is just plain Velocity code. Note the use of casing:
    place-holders and variables used to generated code use lowercase, underscores and dashes, 
    real variables in generated code use camelCase. -->
    <generate-macro-foreach>
#foreach( $macro_name in $-map_name- )
    #set( $chanw_foreach_statement = $-code_name-.replaceAll( "-macro_name-", $macro_name ) )
    #evaluate( $chanw_foreach_statement )
#end
    </generate-macro-foreach>
    
    <index-block-macro>
#macro( -macro_name- $-node_type-Node )
    #if( $-node_type-Node.name != $-element_name- )
        Not a/an -node_type-!!!$BR
        #stop
    #end
    #chanwGetNodeValues( $-node_type-Node $-map_name- )
#end
    </index-block-macro>
    
    <single-group>
#macro(-dispatch_macro_name- $systemDataStructure)
    #set($groupToBeProcessed=$systemDataStructure.getChild('-single_group_name-'))
    #chanwConvertToPascalCase('-single_group_name-' '-')
    #set($macroName=$MACRO_PREFIX+$chanwConvertToPascalCase)
    #chanwInvokeMacro($macroName ['groupToBeProcessed'])
#end
    </single-group>
    
    <multi-group>
#macro(-macro_name- $systemDataStructure $region)
    #set($groupType=$systemDataStructure.getChild('choose-type').value)
    #set($groupRegion=$systemDataStructure.getChild('choose-region').value)
    #set($groupToBeProcessed=$systemDataStructure.getChild("${groupType}-group"))
    #chanwConvertToPascalCase($groupType '-')
    #set($macroName=$MACRO_PREFIX+$chanwConvertToPascalCase+'Group')
    #if(!$_PropertyTool.isNull($region))
        #set($blockRegion=$region)
        #chanwInvokeMacro($macroName ['groupToBeProcessed','blockRegion'])
    #else
        #chanwInvokeMacro($macroName ['groupToBeProcessed'])
    #end
#end     
    </multi-group>
    
    <site-map>
#macro( -macro_name- $systemIndexBlock )
    #chanwCreateSiteMap( $systemIndexBlock )
#end
    </site-map>
</global-velocity-code>